import{r as o,j as e,c as b,R as g}from"./client-B9F7oGqJ.js";import{D as j,g as S,i as v,s as N}from"./storage-NNWWAa_K.js";const f=[{id:"apa",label:"APA (7th Edition)"},{id:"mla",label:"MLA (9th Edition)"},{id:"chicago",label:"Chicago (Author-Date)"},{id:"ieee",label:"IEEE"},{id:"harvard",label:"Harvard"},{id:"vancouver",label:"Vancouver"}];function E(){const[a,n]=o.useState(j),[r,l]=o.useState(""),[h,i]=o.useState("success"),[m,p]=o.useState(!0);if(o.useEffect(()=>{S().then(s=>{n(s),p(!1)})},[]),m)return e.jsx("main",{className:"options-root",children:e.jsxs("section",{className:"options-panel loading-state",children:[e.jsx("p",{className:"eyebrow",children:"Source Finder"}),e.jsx("h1",{children:"Control Room Settings"}),e.jsx("p",{children:"Loading settings..."})]})});const x=async s=>{s.preventDefault();const t=a.apiBaseUrl.trim();if(!v(t)){i("error"),l("Enter a valid API base URL, such as http://localhost:3000");return}const c={...a,apiBaseUrl:t,debounceMs:Math.max(300,Math.min(5e3,Number(a.debounceMs)||1500)),maxResults:Math.max(1,Math.min(10,Number(a.maxResults)||5))};try{await N(c),n(c),i("success"),l("Saved. New lookups will use these settings.")}catch(d){i("error"),l(d instanceof Error?d.message:"Could not save settings.")}};return e.jsx("main",{className:"options-root",children:e.jsxs("section",{className:"options-panel",children:[e.jsxs("header",{className:"options-header",children:[e.jsx("p",{className:"eyebrow",children:"Source Finder"}),e.jsx("h1",{children:"Control Room Settings"}),e.jsx("p",{className:"lead",children:"Tune backend access, citation formatting, and lookup cadence."})]}),e.jsxs("form",{onSubmit:x,className:"options-form",children:[e.jsxs("section",{className:"form-block",children:[e.jsx("h2",{children:"Connection"}),e.jsxs("label",{children:["Backend API Base URL",e.jsx("input",{type:"url",value:a.apiBaseUrl,onChange:s=>{n(t=>({...t,apiBaseUrl:s.target.value}))},placeholder:"http://localhost:3000",required:!0})]})]}),e.jsxs("section",{className:"form-block",children:[e.jsx("h2",{children:"Citation Output"}),e.jsxs("label",{children:["Citation Style",e.jsx("select",{value:a.style,onChange:s=>{n(t=>({...t,style:s.target.value}))},children:f.map(s=>e.jsx("option",{value:s.id,children:s.label},s.id))})]})]}),e.jsxs("section",{className:"form-block",children:[e.jsx("h2",{children:"Lookup Behavior"}),e.jsxs("label",{children:["Auto Lookup Debounce (ms)",e.jsx("input",{type:"number",min:300,max:5e3,step:100,value:a.debounceMs,onChange:s=>{n(t=>({...t,debounceMs:Number(s.target.value)}))}})]}),e.jsxs("label",{children:["Max Results",e.jsx("input",{type:"number",min:1,max:10,step:1,value:a.maxResults,onChange:s=>{n(t=>({...t,maxResults:Number(s.target.value)}))}})]})]}),e.jsxs("label",{className:"checkbox",children:[e.jsx("input",{type:"checkbox",checked:a.debugMode,onChange:s=>{n(t=>({...t,debugMode:s.target.checked}))}}),e.jsx("span",{children:"Enable debug logs in the background worker console."})]}),e.jsxs("div",{className:"form-footer",children:[e.jsx("p",{className:"helper-text",children:"Changes apply to new lookups immediately."}),e.jsx("button",{type:"submit",children:"Save Settings"})]})]}),r?e.jsx("p",{className:`status ${h}`,children:r}):null]})})}const u=document.getElementById("root");if(!u)throw new Error("Missing #root element for options page.");b(u).render(e.jsx(g.StrictMode,{children:e.jsx(E,{})}));
